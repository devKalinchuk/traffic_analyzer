# üîí Advanced PCAP Threat Analyzer

–ê–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä PCAP-—Ñ–∞–π–ª—ñ–≤ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–∞–≥—Ä–æ–∑ –º–µ—Ä–µ–∂–µ–≤–æ—ó –±–µ–∑–ø–µ–∫–∏. –†–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –∑ –¥–æ–ø–æ–º–æ–≥–æ—é –®–Ü Claude

## üéØ –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

### –í–∏—è–≤–ª–µ–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –∑–∞–≥—Ä–æ–∑
- üî¥ **Reverse Shell** - –≤–∏—è–≤–ª–µ–Ω–Ω—è backdoor –∑'—î–¥–Ω–∞–Ω—å
- üî¥ **C2 Beaconing** - –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è –∑ Command & Control —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- üî¥ **ARP Spoofing** - –∞—Ç–∞–∫–∏ Man-in-the-Middle
- üî¥ **SMB Exploits** - EternalBlue —Ç–∞ —ñ–Ω—à—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏
- üî¥ **Webshell** - –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ –≤–µ–±
- üî¥ **Malicious TLS** - –≤–∏—è–≤–ª–µ–Ω–Ω—è malware –ø–æ JA3 fingerprint

### –í–∏—è–≤–ª–µ–Ω–Ω—è –∞—Ç–∞–∫ –≤–∏—Å–æ–∫–æ–≥–æ —Ä–∏–∑–∏–∫—É
- üü† **Data Exfiltration** - –≤–∏—Ç—ñ–∫ –¥–∞–Ω–∏—Ö –∑ –ø–æ–∫—Ä–∞—â–µ–Ω–æ—é –µ–≤—Ä–∏—Å—Ç–∏–∫–æ—é
- üü† **Port Scanning** - —Ä–µ–∞–ª—å–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ (–Ω–µ –∑–≤–∏—á–∞–π–Ω–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å)
- üü† **DNS Tunneling** - –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É –≤ DNS
- üü† **SQL Injection** - –≤–µ–±-–∞—Ç–∞–∫–∏ —É —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–π–æ–≤–∞–Ω–∏—Ö TCP –ø–æ—Ç–æ–∫–∞—Ö
- üü† **Crypto Mining** - –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ mining pools

### –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏
‚úÖ **–ü–æ—Ç–æ–∫–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞** - –Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂—É—î –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É –ø–∞–º'—è—Ç—å (–ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ñ–∞–π–ª—ñ–≤ 10+ GB)  
‚úÖ **TCP Stream Reassembly** - –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤–∞–Ω–∏—Ö –∞—Ç–∞–∫  
‚úÖ **TLS Fingerprinting (JA3)** - –∞–Ω–∞–ª—ñ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É  
‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –µ–≤—Ä–∏—Å—Ç–∏–∫–∞** - –º—ñ–Ω—ñ–º—É–º false positives  
‚úÖ **Threat Intelligence** - –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ AbuseIPDB  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ**

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑
```bash
python pcap_analyzer.py capture.pcap
```

### –í–∫–∞–∑–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—É –º–µ—Ä–µ–∂—É
```bash
python pcap_analyzer.py capture.pcap --network 10.0.0.0/8
```

### –ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é Threat Intelligence
```bash
python pcap_analyzer.py capture.pcap --threat-intel
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Threat Intelligence –ø–æ—Ç—Ä—ñ–±–µ–Ω API –∫–ª—é—á [AbuseIPDB](https://www.abuseipdb.com/). –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é `check_threat_intelligence()` —É –∫–æ–¥—ñ.

## üìä –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É

```
================================================================================
–ü–†–û–§–ï–°–Ü–ô–ù–ò–ô –ó–í–Ü–¢ –ü–†–û –ó–ê–ì–†–û–ó–ò –ë–ï–ó–ü–ï–ö–ò
================================================================================
–§–∞–π–ª: suspicious_traffic.pcap
–î–∞—Ç–∞ –∞–Ω–∞–ª—ñ–∑—É: 2025-12-19 15:30:45
–í—Å—å–æ–≥–æ –ø–∞–∫–µ—Ç—ñ–≤: 156342
–û–±—Ä–æ–±–ª–µ–Ω–æ –ø–∞–∫–µ—Ç—ñ–≤: 156342
TCP –ø–æ—Ç–æ–∫—ñ–≤ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ: 234
–õ–æ–∫–∞–ª—å–Ω–∞ –º–µ—Ä–µ–∂–∞: 192.168.1.0/24
–õ–æ–∫–∞–ª—å–Ω–∏—Ö —Ö–æ—Å—Ç—ñ–≤: 12
–í–∏—è–≤–ª–µ–Ω–æ –∑–∞–≥—Ä–æ–∑: 5
================================================================================

                      [!!! –ö–†–ò–¢–ò–ß–ù–Ü –ó–ê–ì–†–û–ó–ò !!!]                      
================================================================================

1. C2_BEACONING
   –í–∏—è–≤–ª–µ–Ω–æ C2 beaconing –∑ 192.168.1.105
   –î–µ—Ç–∞–ª—ñ: –†–µ–≥—É–ª—è—Ä–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –¥–æ 185.220.101.42 –∫–æ–∂–Ω—ñ 60.2s (47 –∑'—î–¥–Ω–∞–Ω—å, œÉ=2.15)

2. REVERSE_SHELL
   –ú–æ–∂–ª–∏–≤–µ reverse shell –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç—É
   –î–µ—Ç–∞–ª—ñ: 192.168.1.105 -> 185.220.101.42:4444 (Metasploit default)

                           [! –í–ò–°–û–ö–ò–ô –†–ò–ó–ò–ö !]                           
================================================================================

1. PORT_SCAN_INBOUND
   –í—Ö—ñ–¥–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ –∑ 198.51.100.25
   –î–µ—Ç–∞–ª—ñ: 127 –ø–æ—Ä—Ç—ñ–≤ –ø—Ä–æ—Å–∫–∞–Ω–æ–≤–∞–Ω–∞–Ω–æ, 87.4% –≤—ñ–¥–º–æ–≤
```

## üîß –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ
–Ø–∫—â–æ –≤–∞—à–∞ –º–µ—Ä–µ–∂–∞ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó `192.168.0.0/16`:

```bash
python pcap_analyzer.py capture.pcap --network 172.16.0.0/12
python pcap_analyzer.py capture.pcap --network 10.0.0.0/8
```

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è AbuseIPDB
1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π API –∫–ª—é—á –Ω–∞ [AbuseIPDB](https://www.abuseipdb.com/)
2. –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é `check_threat_intelligence()`:

```python
def check_threat_intelligence(self, ip):
    if not self.use_threat_intel or ip in self.threat_intel_cache:
        return self.threat_intel_cache.get(ip)
    
    try:
        api_key = 'YOUR_API_KEY_HERE'  # –í—Å—Ç–∞–≤—Ç–µ —Å–≤—ñ–π –∫–ª—é—á
        url = f'https://api.abuseipdb.com/api/v2/check?ipAddress={ip}'
        headers = {'Key': api_key, 'Accept': 'application/json'}
        response = requests.get(url, headers=headers, timeout=2)
        data = response.json()
        result = data.get('data', {}).get('abuseConfidenceScore', 0)
        self.threat_intel_cache[ip] = result
        return result
    except:
        pass
    
    return 0
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö JA3 fingerprints
–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Å–ª–æ–≤–Ω–∏–∫ `MALICIOUS_JA3`:

```python
self.MALICIOUS_JA3 = {
    'e7d705a3286e19ea42f587b344ee6865': 'Trickbot',
    'a0e9f5d64349fb13191bc781f81f42e1': 'Metasploit',
    'YOUR_JA3_HASH_HERE': 'Your Malware Name',
}
```

### –Ü–¥–µ—ó –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω—å:
- [ ] –î–æ–¥–∞—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É PCAPNG —Ñ–æ—Ä–º–∞—Ç—É
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ VirusTotal API
- [ ] –ï–∫—Å–ø–æ—Ä—Ç –∑–≤—ñ—Ç—ñ–≤ —É JSON/HTML
- [ ] GUI —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [ ] –†–µ–∞–ª—Ç–∞–π–º –∞–Ω–∞–ª—ñ–∑ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É
- [ ] –î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ JA3 —Å–∏–≥–Ω–∞—Ç—É—Ä
- [ ] ML-based –∞–Ω–æ–º–∞–ª—ñ—ó detection
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ YARA –ø—Ä–∞–≤–∏–ª–∞–º–∏

## ‚ö†Ô∏è –í—ñ–¥–º–æ–≤–∞ –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –≤–∏–∫–ª—é—á–Ω–æ –¥–ª—è **–ª–µ–≥–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π** - –∞–Ω–∞–ª—ñ–∑—É –±–µ–∑–ø–µ–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –º–µ—Ä–µ–∂ –∞–±–æ –º–µ—Ä–µ–∂, –Ω–∞ —è–∫—ñ —É –≤–∞—Å —î –¥–æ–∑–≤—ñ–ª. –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –Ω–µ–ø—Ä–∞–≤–æ–º—ñ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è.

---

**‚≠ê –Ø–∫—â–æ —Ü–µ–π –ø—Ä–æ—î–∫—Ç –≤–∞–º –¥–æ–ø–æ–º—ñ–≥, –ø–æ—Å—Ç–∞–≤—Ç–µ –∑—ñ—Ä–∫—É –Ω–∞ GitHub! ‚≠ê**
